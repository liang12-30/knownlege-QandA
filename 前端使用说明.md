# 前端使用说明

## 📦 文件说明

- `frontend.html` - 单页面应用，包含完整的 HTML、CSS 和 JavaScript

## 🚀 快速开始

### 步骤 1：启动后端 API 服务

在使用前端之前，必须先启动后端 API 服务：

```bash
# 确保已经构建了知识库和向量索引
python quick_start.py

# 或者直接启动 API 服务
python api_server.py
```

启动成功后，API 服务将在 `http://localhost:8000` 运行。

### 步骤 2：打开前端页面

有两种方式打开前端：

#### 方式一：直接打开（推荐）

直接双击 `frontend.html` 文件，会在默认浏览器中打开。

#### 方式二：使用本地服务器

```bash
# Python 3
python -m http.server 8080

# 然后访问 http://localhost:8080/frontend.html
```

### 步骤 3：开始使用

1. **检查状态**：页面加载后会自动检查 API 服务状态
   - 🟢 绿色圆点：服务在线
   - 🔴 红色圆点：服务离线

2. **输入问题**：在文本框中输入您的问题

3. **提交查询**：点击"提交问题"按钮或按 `Ctrl+Enter` (Windows) / `Cmd+Enter` (Mac)

4. **查看结果**：系统会显示最相关的 3 个知识点

## ✨ 功能特性

### 1. 智能问答
- 支持单个问题查询
- 自动识别问题意图（普通查询、多意图、推理、摘要等）
- 返回最相关的前 3 个知识点

### 2. 服务状态监控
- 实时显示 API 服务状态
- 自动检测连接问题
- 友好的错误提示

### 3. 示例问题
- 提供常见问题示例
- 点击即可快速填充
- 帮助用户快速上手

### 4. 美观的界面
- 现代化渐变设计
- 流畅的动画效果
- 响应式布局（支持手机、平板、桌面）

### 5. 友好的交互
- 加载状态提示
- 错误信息显示
- 平滑滚动到结果
- 快捷键支持（Ctrl/Cmd + Enter）

## 🎨 界面说明

### 顶部区域
- **标题**：系统名称
- **状态指示器**：显示 API 服务状态
  - 绿色闪烁：服务在线
  - 红色闪烁：服务离线

### 问题输入区
- **输入框**：支持多行输入
- **自动聚焦**：点击示例问题后自动聚焦

### 按钮组
- **提交问题**：发送问题到 API 进行查询
- **清空结果**：清除当前显示的结果

### 示例问题区
- 提供 5 个常见问题示例
- 点击即可填充到输入框

### 结果显示区
- **问题头部**：显示原始问题和元数据
  - 意图类型
  - 知识点数量
- **知识点卡片**：每个知识点一张卡片
  - 序号
  - 相关度分数
  - 完整内容

## 🛠️ 配置说明

### 修改 API 地址

如果您的 API 服务运行在其他地址，请编辑 `frontend.html` 文件：

```javascript
// 找到这一行（大约在第 394 行）
const API_BASE_URL = 'http://localhost:8000';

// 修改为您的 API 地址，例如：
const API_BASE_URL = 'http://192.168.1.100:8000';
```

### 自定义样式

所有样式都在 `<style>` 标签内，您可以根据需要修改：

- **主题色**：搜索 `#667eea` 和 `#764ba2` 修改渐变色
- **字体**：修改 `font-family`
- **动画速度**：修改 `transition` 和 `animation` 时间

## 📱 兼容性

### 浏览器支持
- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

### 设备支持
- ✅ 桌面电脑（1920x1080 及以上）
- ✅ 笔记本（1366x768 及以上）
- ✅ 平板（768px 宽度及以上）
- ✅ 手机（375px 宽度及以上）

## ⚠️ 常见问题

### 1. 显示"无法连接到服务"

**原因**：后端 API 服务未启动或地址不正确

**解决**：
```bash
# 启动 API 服务
python api_server.py

# 确认服务运行在 http://localhost:8000
```

### 2. 跨域问题（CORS）

**现象**：浏览器控制台显示 CORS 错误

**解决**：
- 如果直接双击打开 HTML 文件，通常不会有跨域问题
- 如果使用本地服务器，确保 API 服务允许跨域访问

如需修改 API 服务支持 CORS，在 `api_server.py` 中添加：

```python
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # 生产环境建议设置具体域名
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### 3. 加载很慢

**原因**：
- 问题复杂度高
- 网络延迟
- 知识库较大

**解决**：
- 耐心等待，系统会显示加载动画
- 检查后端日志确认处理进度

### 4. 知识点显示不全

**原因**：知识点内容超过 1500 字符会被截断（后端限制）

**这是正常的**：系统设计为返回精简的知识点摘要

## 🔧 高级功能

### 批量查询（需要修改代码）

如果需要批量查询功能，可以添加以下代码：

```javascript
// 批量查询示例
async function batchQuery(questions) {
    const response = await fetch(`${API_BASE_URL}/batch_answer`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ questions: questions })
    });
    
    const data = await response.json();
    return data.results;
}

// 使用示例
const questions = [
    "如何开通手机银行？",
    "个人住房贷款流程",
    "企业网银功能"
];

const results = await batchQuery(questions);
console.log(results);
```

### 添加历史记录

可以使用 `localStorage` 保存查询历史：

```javascript
// 保存到历史
function saveToHistory(question) {
    let history = JSON.parse(localStorage.getItem('qaHistory') || '[]');
    history.unshift({
        question: question,
        timestamp: new Date().toISOString()
    });
    // 只保留最近 10 条
    history = history.slice(0, 10);
    localStorage.setItem('qaHistory', JSON.stringify(history));
}

// 加载历史
function loadHistory() {
    return JSON.parse(localStorage.getItem('qaHistory') || '[]');
}
```

## 📊 性能优化建议

1. **问题长度**：建议控制在 200 字以内，过长的问题可能影响检索准确度

2. **清晰描述**：使用明确的金融术语，避免口语化表达

3. **单一主题**：每次查询聚焦一个主题，获得更精准的结果

4. **利用示例**：参考示例问题的格式来组织您的问题

## 📝 更新日志

- **v1.0.0** (2024-11-13)
  - 初始版本发布
  - 支持单问题查询
  - 实时状态监控
  - 响应式设计
  - 示例问题功能

---

## 🎉 开始使用

1. 启动后端：`python api_server.py`
2. 打开前端：双击 `frontend.html`
3. 输入问题，点击提交
4. 查看智能检索结果

**祝您使用愉快！** 💰

